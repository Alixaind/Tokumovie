<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Tonton Film</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Video.js -->
  <link href="https://vjs.zencdn.net/7.21.1/video-js.css" rel="stylesheet" />
  <script src="https://vjs.zencdn.net/7.21.1/video.min.js"></script>

  <style>
    body { background-color: #000; }
  </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4 space-y-4">

  <h1 id="movie-title" class="text-white text-2xl font-bold"></h1>

  <!-- Video Player -->
  <video
    id="my-video"
    class="video-js vjs-big-play-centered rounded shadow-lg w-full max-w-4xl"
    controls
    preload="auto"
    data-setup='{}'>
    <source src="" type="video/mp4" />
    Browser tidak mendukung video.
  </video>

  <!-- Next Episode -->
  <div id="next-episode" class="hidden">
    <a id="next-link"
       href="#"
       class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded text-white">
       ▶ Next Episode
    </a>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const movieId = parseInt(urlParams.get("id"));
    let nextMovie = null; // simpan episode berikutnya

    fetch("movies.json")
      .then(res => res.json())
      .then(data => {
        const movie = data.find(m => m.id === movieId);
        if (movie) {
          // Set judul dan sumber video
          document.getElementById("movie-title").textContent = movie.title;
          const video = document.querySelector("#my-video source");
          video.src = movie.src;
          video.parentElement.load();

          // Cek episode berikutnya
          nextMovie = data.find(m => m.id === movieId + 1);
          if (nextMovie) {
            const nextEpisodeDiv = document.getElementById("next-episode");
            const nextLink = document.getElementById("next-link");
            nextLink.href = `movie.html?id=${nextMovie.id}`;
            nextLink.textContent = `▶ Next Episode: ${nextMovie.title}`;
            nextEpisodeDiv.classList.remove("hidden");
          }

          // Autoplay ke episode berikutnya saat selesai
          const player = video.parentElement; // video element
          player.addEventListener("ended", () => {
            if (nextMovie) {
              window.location.href = `movie.html?id=${nextMovie.id}`;
            }
          });
        } else {
          document.body.innerHTML = "<p class='text-white'>Film tidak ditemukan.</p>";
        }
      });
  </script>
</body>
</html>